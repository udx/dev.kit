{
  "header": [
    "# Codex exec policy rules (outside-sandbox commands)",
    "# Goal: prompt for destructive actions and apply/update operations."
  ],
  "groups": [
    {
      "title": "Destructive actions",
      "rules": [
        { "pattern": ["rm"], "decision": "prompt" },
        { "pattern": ["rmdir"], "decision": "prompt" },
        { "pattern": ["unlink"], "decision": "prompt" },
        { "pattern": ["git", "clean"], "decision": "prompt" },
        { "pattern": ["git", "reset", "--hard"], "decision": "prompt" },
        { "pattern": ["git", "checkout", "--"], "decision": "prompt" },
        { "pattern": ["git", "restore", "--source"], "decision": "prompt" }
      ]
    },
    {
      "title": "Apply / update operations",
      "rules": [
        { "pattern": ["git", "apply"], "decision": "prompt" },
        { "pattern": ["git", "am"], "decision": "prompt" },
        { "pattern": ["terraform", "apply"], "decision": "prompt" },
        { "pattern": ["kubectl", "apply"], "decision": "prompt" },
        { "pattern": ["helm", "upgrade"], "decision": "prompt" },
        { "pattern": ["ansible-playbook"], "decision": "prompt" },
        { "pattern": ["brew", "update"], "decision": "prompt" },
        { "pattern": ["brew", "upgrade"], "decision": "prompt" },
        { "pattern": ["apt", "update"], "decision": "prompt" },
        { "pattern": ["apt", "upgrade"], "decision": "prompt" },
        { "pattern": ["apt-get", "update"], "decision": "prompt" },
        { "pattern": ["apt-get", "upgrade"], "decision": "prompt" },
        { "pattern": ["dnf", "update"], "decision": "prompt" },
        { "pattern": ["dnf", "upgrade"], "decision": "prompt" },
        { "pattern": ["yum", "update"], "decision": "prompt" },
        { "pattern": ["yum", "upgrade"], "decision": "prompt" },
        { "pattern": ["npm", "update"], "decision": "prompt" },
        { "pattern": ["pnpm", "update"], "decision": "prompt" },
        { "pattern": ["yarn", "upgrade"], "decision": "prompt" }
      ]
    }
  ]
}

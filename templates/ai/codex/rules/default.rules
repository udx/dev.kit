# Codex exec policy rules (outside-sandbox commands)
# Goal: prompt for destructive actions and apply/update operations.

# Destructive actions
prefix_rule(pattern=["rm"], decision="prompt")
prefix_rule(pattern=["rmdir"], decision="prompt")
prefix_rule(pattern=["unlink"], decision="prompt")
prefix_rule(pattern=["git", "clean"], decision="prompt")
prefix_rule(pattern=["git", "reset", "--hard"], decision="prompt")
prefix_rule(pattern=["git", "checkout", "--"], decision="prompt")
prefix_rule(pattern=["git", "restore", "--source"], decision="prompt")

# Apply / update operations
prefix_rule(pattern=["git", "apply"], decision="prompt")
prefix_rule(pattern=["git", "am"], decision="prompt")
prefix_rule(pattern=["terraform", "apply"], decision="prompt")
prefix_rule(pattern=["kubectl", "apply"], decision="prompt")
prefix_rule(pattern=["helm", "upgrade"], decision="prompt")
prefix_rule(pattern=["ansible-playbook"], decision="prompt")

prefix_rule(pattern=["brew", "update"], decision="prompt")
prefix_rule(pattern=["brew", "upgrade"], decision="prompt")

prefix_rule(pattern=["apt", "update"], decision="prompt")
prefix_rule(pattern=["apt", "upgrade"], decision="prompt")
prefix_rule(pattern=["apt-get", "update"], decision="prompt")
prefix_rule(pattern=["apt-get", "upgrade"], decision="prompt")

prefix_rule(pattern=["dnf", "update"], decision="prompt")
prefix_rule(pattern=["dnf", "upgrade"], decision="prompt")
prefix_rule(pattern=["yum", "update"], decision="prompt")
prefix_rule(pattern=["yum", "upgrade"], decision="prompt")

prefix_rule(pattern=["npm", "update"], decision="prompt")
prefix_rule(pattern=["pnpm", "update"], decision="prompt")
prefix_rule(pattern=["yarn", "upgrade"], decision="prompt")

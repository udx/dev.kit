{
  "id": "codex",
  "version": "0.1",
  "title": "Codex Integration",
  "description": "Manage Codex integration, rules, and module metadata for dev.kit.",
  "tags": ["codex", "ai", "rules", "integration"],
  "components": {
    "docs": [
      {
        "id": "codex.overview",
        "path": "src/context/30_module/ai/codex/overview.md",
        "tags": ["codex", "ai", "module"]
      },
      {
        "id": "codex.workflows",
        "path": "src/context/30_module/ai/codex/workflows.md",
        "tags": ["codex", "workflow"]
      },
      {
        "id": "codex.skills",
        "path": "src/context/30_module/ai/codex/skills.md",
        "tags": ["codex", "skills"]
      },
      {
        "id": "codex.mcp",
        "path": "src/context/30_module/ai/codex/mcp.md",
        "tags": ["codex", "mcp"]
      },
      {
        "id": "codex.integration",
        "path": "src/context/20_config/guides/codex-integration.md",
        "tags": ["codex", "ai", "integration"]
      },
      {
        "id": "codex.prompting.guide",
        "path": "src/context/20_config/references/codex_prompting_guide.md",
        "tags": ["codex", "prompting", "rules"]
      },
      {
        "id": "ai.integration.contract",
        "path": "src/context/40_ai/overview.md",
        "tags": ["ai", "contract"]
      },
      {
        "id": "ai.deterministic.prompting",
        "path": "src/context/20_config/principles/ai/deterministic-artifact-generation.md",
        "tags": ["ai", "deterministic", "prompting"]
      },
      {
        "id": "experience.incremental",
        "path": "src/context/20_config/principles/incremental-experience.md",
        "tags": ["experience", "iteration"]
      }
    ],
    "prompts": [
      {
        "id": "codex.integration.enable",
        "text": "enable codex integration with dev.kit",
        "workflow_id": "codex.integration.enable"
      },
      {
        "id": "codex.rules.update",
        "text": "update codex rules for dev.kit",
        "workflow_id": "codex.integration.enable"
      },
      {
        "id": "codex.rules.plan",
        "text": "preview codex rules changes",
        "workflow_id": "codex.rules.plan"
      },
      {
        "id": "codex.rules.get",
        "text": "show current codex rules",
        "workflow_id": "codex.rules.get"
      },
      {
        "id": "codex.rules.location",
        "text": "where is codex rules file",
        "workflow_id": "codex.rules.location"
      }
    ],
    "workflows": [
      {
        "id": "codex.integration.enable",
        "title": "Enable Codex integration (dev.kit-first)",
        "edge_cases": [
          "If Codex is not installed, provide install steps before rules update.",
          "If rules file is missing, create it after user confirmation."
        ],
        "steps": [
          {
            "id": "codex.rules.path",
            "command": "ls -la \"$HOME/.codex/rules\"",
            "note": "Locate Codex rules directory.",
            "runnable": false
          },
          {
            "id": "codex.rules.plan",
            "command": "dev.kit codex --plan-rules",
            "note": "Preview rules changes before applying.",
            "runnable": false
          },
          {
            "id": "codex.rules.backup",
            "command": "cp \"$HOME/.codex/rules/default.rules\" \"$HOME/.codex/rules/default.rules.bak\"",
            "note": "Backup rules before update.",
            "runnable": false
          },
          {
            "id": "codex.rules.update",
            "command": "dev.kit codex --apply-rules",
            "note": "Apply dev.kit-first rules template.",
            "runnable": false,
            "protected": true,
            "preview_command": "dev.kit codex --plan-rules"
          }
        ],
        "response": {
          "instructions": [
            "Confirm Codex is installed before changing rules.",
            "Backup rules before applying any updates.",
            "Preview the rules diff, then apply dev.kit-first rules."
          ],
          "normalized": "To enable Codex integration, verify Codex is installed, back up your rules, then apply dev.kit-first rules so prompts route through dev.kit."
        }
      },
      {
        "id": "codex.rules.plan",
        "title": "Preview Codex rules changes",
        "steps": [
          {
            "id": "codex.rules.plan",
            "command": "dev.kit codex --plan-rules",
            "note": "Show diff between current and dev.kit rules.",
            "runnable": false
          }
        ],
        "response": {
          "instructions": [
            "Preview the rules diff before applying changes."
          ],
          "normalized": "Use dev.kit codex --plan-rules to preview rule changes before applying."
        }
      },
      {
        "id": "codex.rules.get",
        "title": "Show current Codex rules",
        "steps": [
          {
            "id": "codex.rules.get",
            "command": "dev.kit codex --get-rules",
            "note": "Print current rules file.",
            "runnable": false
          }
        ],
        "response": {
          "instructions": [
            "Read the current Codex rules to confirm contents."
          ],
          "normalized": "Use dev.kit codex --get-rules to display the current rules file."
        }
      },
      {
        "id": "codex.rules.location",
        "title": "Locate Codex rules and config",
        "edge_cases": [
          "If Codex config is missing, use default locations or run Codex once to generate."
        ],
        "steps": [
          {
            "id": "codex.rules.path",
            "command": "ls -la \"$HOME/.codex/rules\"",
            "note": "List Codex rules directory.",
            "runnable": false
          },
          {
            "id": "codex.config.path",
            "command": "ls -la \"$HOME/.codex\"",
            "note": "List Codex config directory.",
            "runnable": false
          }
        ],
        "response": {
          "instructions": [
            "Check default Codex rules directory under ~/.codex/rules.",
            "Confirm config files under ~/.codex."
          ],
          "normalized": "Codex rules typically live at ~/.codex/rules and config at ~/.codex; list those directories to confirm."
        }
      }
    ]
  }
}
